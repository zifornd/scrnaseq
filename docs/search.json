[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "scrnaseq",
    "section": "",
    "text": "To learn more about Quarto websites visit https://quarto.org/docs/websites.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "analysis/data-loading.html",
    "href": "analysis/data-loading.html",
    "title": "Data loading",
    "section": "",
    "text": "This analysis document is used to load data from 10x Genomics experiments."
  },
  {
    "objectID": "analysis/data-loading.html#setup",
    "href": "analysis/data-loading.html#setup",
    "title": "Data loading",
    "section": "Setup",
    "text": "Setup\nRestore project dependencies:\n\nrenv::restore()\n\n* The library is already synchronized with the lockfile.\n\n\nLoad Bioconductor package(s):\n\nlibrary(DropletUtils)\n\nLoading required package: SingleCellExperiment\n\n\nLoading required package: SummarizedExperiment\n\n\nLoading required package: MatrixGenerics\n\n\nLoading required package: matrixStats\n\n\nWarning: package 'matrixStats' was built under R version 4.1.2\n\n\n\nAttaching package: 'MatrixGenerics'\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n\n\nLoading required package: GenomicRanges\n\n\nLoading required package: stats4\n\n\nLoading required package: BiocGenerics\n\n\nLoading required package: parallel\n\n\n\nAttaching package: 'BiocGenerics'\n\n\nThe following objects are masked from 'package:parallel':\n\n    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,\n    clusterExport, clusterMap, parApply, parCapply, parLapply,\n    parLapplyLB, parRapply, parSapply, parSapplyLB\n\n\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n\n\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, append, as.data.frame, basename, cbind, colnames,\n    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,\n    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,\n    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,\n    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,\n    union, unique, unsplit, which.max, which.min\n\n\nLoading required package: S4Vectors\n\n\n\nAttaching package: 'S4Vectors'\n\n\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n\n\nLoading required package: IRanges\n\n\nLoading required package: GenomeInfoDb\n\n\nLoading required package: Biobase\n\n\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n\n\n\nAttaching package: 'Biobase'\n\n\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n\nlibrary(batchelor)\nlibrary(scuttle)\n\nLoad gene annotation object:\n\nlibrary(params$annotation, character.only = TRUE)\n\nLoading required package: ensembldb\n\n\nLoading required package: GenomicFeatures\n\n\nLoading required package: AnnotationDbi\n\n\nLoading required package: AnnotationFilter\n\n\n\nAttaching package: 'ensembldb'\n\n\nThe following object is masked from 'package:stats':\n\n    filter\n\nann <- eval(parse(text = params$annotation))"
  },
  {
    "objectID": "analysis/data-loading.html#processing",
    "href": "analysis/data-loading.html#processing",
    "title": "Data loading",
    "section": "Processing",
    "text": "Processing\nLoad data from 10x Genomics experiment(s):\n\nsce <- read10xCounts(params$samples, sample.names = params$sample.names)\n\nMake feature names unique:\n\nrownames(sce) <- uniquifyFeatureNames(\n  ID = rowData(sce)$ID, \n  names = rowData(sce)$Symbol\n)\n\nGet the chromosome name:\n\nrowData(sce)$Chrom <- mapIds(\n  x = ann, \n  keys = rowData(sce)$ID, \n  column = \"SEQNAME\", \n  keytype = \"GENEID\"\n)\n\nWarning: Unable to map 1382 of 32738 requested IDs.\n\n\nDivide object into batches:\n\nsce <- divideIntoBatches(sce, sce$Sample)$batches"
  },
  {
    "objectID": "analysis/data-loading.html#summary",
    "href": "analysis/data-loading.html#summary",
    "title": "Data loading",
    "section": "Summary",
    "text": "Summary\nSave experiment object(s):\n\nsaveRDS(sce, file = \"output/data-loading.rds\")\n\nPrint session information\n\nsessionInfo()\n\nR version 4.1.1 (2021-08-10)\nPlatform: x86_64-apple-darwin17.0 (64-bit)\nRunning under: macOS Big Sur 10.16\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\nattached base packages:\n[1] parallel  stats4    stats     graphics  grDevices utils     datasets \n[8] methods   base     \n\nother attached packages:\n [1] EnsDb.Hsapiens.v86_2.99.0   ensembldb_2.16.4           \n [3] AnnotationFilter_1.16.0     GenomicFeatures_1.44.2     \n [5] AnnotationDbi_1.54.1        scuttle_1.2.1              \n [7] batchelor_1.8.1             DropletUtils_1.12.3        \n [9] SingleCellExperiment_1.14.1 SummarizedExperiment_1.22.0\n[11] Biobase_2.52.0              GenomicRanges_1.44.0       \n[13] GenomeInfoDb_1.28.4         IRanges_2.26.0             \n[15] S4Vectors_0.30.2            BiocGenerics_0.38.0        \n[17] MatrixGenerics_1.4.3        matrixStats_0.62.0         \n\nloaded via a namespace (and not attached):\n [1] ProtGenerics_1.24.0       bitops_1.0-7             \n [3] bit64_4.0.5               filelock_1.0.2           \n [5] progress_1.2.2            httr_1.4.2               \n [7] tools_4.1.1               utf8_1.2.2               \n [9] R6_2.5.1                  irlba_2.3.5              \n[11] ResidualMatrix_1.2.0      HDF5Array_1.20.0         \n[13] lazyeval_0.2.2            DBI_1.1.2                \n[15] rhdf5filters_1.4.0        tidyselect_1.1.2         \n[17] prettyunits_1.1.1         curl_4.3.2               \n[19] bit_4.0.4                 compiler_4.1.1           \n[21] cli_3.3.0                 BiocNeighbors_1.10.0     \n[23] xml2_1.3.3                DelayedArray_0.18.0      \n[25] rtracklayer_1.52.1        rappdirs_0.3.3           \n[27] Rsamtools_2.8.0           stringr_1.4.0            \n[29] digest_0.6.29             rmarkdown_2.14           \n[31] R.utils_2.11.0            XVector_0.32.0           \n[33] pkgconfig_2.0.3           htmltools_0.5.2          \n[35] sparseMatrixStats_1.4.2   dbplyr_2.1.1             \n[37] fastmap_1.1.0             limma_3.48.3             \n[39] htmlwidgets_1.5.4         rlang_1.0.2              \n[41] rstudioapi_0.13           RSQLite_2.2.13           \n[43] DelayedMatrixStats_1.14.3 BiocIO_1.2.0             \n[45] generics_0.1.2            jsonlite_1.8.0           \n[47] BiocParallel_1.26.2       dplyr_1.0.9              \n[49] R.oo_1.24.0               RCurl_1.98-1.6           \n[51] magrittr_2.0.3            BiocSingular_1.8.1       \n[53] GenomeInfoDbData_1.2.6    Matrix_1.4-1             \n[55] Rcpp_1.0.8.3              Rhdf5lib_1.14.2          \n[57] fansi_1.0.3               lifecycle_1.0.1          \n[59] R.methodsS3_1.8.1         stringi_1.7.6            \n[61] yaml_2.3.5                edgeR_3.34.1             \n[63] zlibbioc_1.38.0           rhdf5_2.36.0             \n[65] BiocFileCache_2.0.0       grid_4.1.1               \n[67] blob_1.2.3                dqrng_0.3.0              \n[69] crayon_1.5.1              lattice_0.20-45          \n[71] Biostrings_2.60.2         beachmat_2.8.1           \n[73] hms_1.1.1                 KEGGREST_1.32.0          \n[75] locfit_1.5-9.5            knitr_1.39               \n[77] pillar_1.7.0              igraph_1.3.1             \n[79] rjson_0.2.21              ScaledMatrix_1.0.0       \n[81] biomaRt_2.48.3            XML_3.99-0.9             \n[83] glue_1.6.2                evaluate_0.15            \n[85] renv_0.15.4               png_0.1-7                \n[87] vctrs_0.4.1               purrr_0.3.4              \n[89] assertthat_0.2.1          cachem_1.0.6             \n[91] xfun_0.30                 rsvd_1.0.5               \n[93] restfulr_0.0.13           tibble_3.1.6             \n[95] GenomicAlignments_1.28.0  memoise_2.0.1            \n[97] ellipsis_0.3.2"
  },
  {
    "objectID": "analysis/droplet-processing.html",
    "href": "analysis/droplet-processing.html",
    "title": "Droplet processing",
    "section": "",
    "text": "Restore project dependencies:\n\nrenv::restore()\n\n* The library is already synchronized with the lockfile.\n\n\nNearest neighbor detection:\n\nlibrary(BiocNeighbors)\n\nBNPARAM <- AnnoyParam()\n\nSingular value decomposition:\n\nlibrary(BiocSingular)\n\nBSPARAM <- RandomParam()\n\nParallel evaluation:\n\nlibrary(BiocParallel)\n\nBPPARAM <- MulticoreParam(8)\n\nLoad Bioconductor package(s):\n\nlibrary(DropletUtils)\n\nLoading required package: SingleCellExperiment\n\n\nLoading required package: SummarizedExperiment\n\n\nLoading required package: MatrixGenerics\n\n\nLoading required package: matrixStats\n\n\nWarning: package 'matrixStats' was built under R version 4.1.2\n\n\n\nAttaching package: 'MatrixGenerics'\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n\n\nLoading required package: GenomicRanges\n\n\nLoading required package: stats4\n\n\nLoading required package: BiocGenerics\n\n\nLoading required package: parallel\n\n\n\nAttaching package: 'BiocGenerics'\n\n\nThe following objects are masked from 'package:parallel':\n\n    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,\n    clusterExport, clusterMap, parApply, parCapply, parLapply,\n    parLapplyLB, parRapply, parSapply, parSapplyLB\n\n\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n\n\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, append, as.data.frame, basename, cbind, colnames,\n    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,\n    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,\n    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,\n    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,\n    union, unique, unsplit, which.max, which.min\n\n\nLoading required package: S4Vectors\n\n\n\nAttaching package: 'S4Vectors'\n\n\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n\n\nLoading required package: IRanges\n\n\nLoading required package: GenomeInfoDb\n\n\nLoading required package: Biobase\n\n\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n\n\n\nAttaching package: 'Biobase'\n\n\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n\n\nLoad CRAN package(s):\n\nlibrary(patchwork)\n\nSource project function(s):\n\nsource(\"code/BarcodeRank.R\")\nsource(\"code/EmpDropsPValue.R\")\nsource(\"code/EmpDropsLogProb.R\")\nsource(\"code/EmpDropsLimited.R\")"
  },
  {
    "objectID": "analysis/droplet-processing.html#processing",
    "href": "analysis/droplet-processing.html#processing",
    "title": "Droplet processing",
    "section": "Processing",
    "text": "Processing\nRead experiment objects(s):\n\nsce <- readRDS(\"output/data-loading.rds\")\n\nCompute barcode rank statistics and identify the knee and inflection points on the total count curve.\n\nbcr <- bplapply(\n  X = sce, \n  FUN = barcodeRanks, \n  lower = params$lower\n)\n\nPlot barcode rank statistics and annotate the knee and inflection points on the total count curve.\n\nwrap_plots(lapply(bcr, BarcodeRank))\n\nLoading required package: ggplot2\n\n\nLoading required package: scales\n\n\nWarning: package 'scales' was built under R version 4.1.2\n\n\nWarning: `label_number_si()` was deprecated in scales 1.2.0.\nPlease use the `scale_cut` argument of `label_number()` instead.\nThis warning is displayed once every 8 hours.\nCall `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.\n\n\nWarning: Transformation introduced infinite values in continuous y-axis\nTransformation introduced infinite values in continuous y-axis\nTransformation introduced infinite values in continuous y-axis\n\n\n\n\n\n\nFUN <- function(x, y) {\n  \n  colData(x)$BarcodeRank = y$rank\n  colData(x)$BarcodeTotal = y$total\n  colData(x)$BarcodeFitted = y$fitted\n  return(x)\n\n}\n\nsce <- bpmapply(\n  FUN = FUN,\n  x = sce,\n  y = bcr\n)\n\n\nTesting barcodes\nIdentify empty droplets:\n\nfit <- bplapply(\n  X = sce, \n  FUN = emptyDrops, \n  lower = params$lower, \n  niters = params$niters\n)\n\n\nwrap_plots(lapply(fit, EmpDropsLogProb, FDR = params$fdr))\n\nWarning: Removed 734124 rows containing missing values (geom_point).\n\n\nWarning: Removed 728795 rows containing missing values (geom_point).\n\n\nWarning: Removed 1464436 rows containing missing values (geom_point).\n\n\n\n\n\n\n\nTesting ambient barcodes\nIdentify empty droplets and return results for barcodes with total UMI count less than or equal to 100:\n\namb <- bplapply(\n  X = sce, \n  FUN = emptyDrops, \n  lower = params$lower, \n  niters = params$niters, \n  test.ambient = TRUE\n)\n\nPlot distribution of the Monte Carlo p-value against the null model:\n\nplt <- lapply(amb, EmpDropsPValue, lower = params$lower)\nwrap_plots(plt)\n\n\n\n\n\nFUN <- function(x, y) {\n  \n  colData(x)$EmpDropsLogProb = y$LogProb\n  colData(x)$EmpDropsPValue = y$PValue\n  colData(x)$EmpDropsLimited = y$Limited\n  colData(x)$EmpDropsFDR = y$FDR\n  return(x)\n\n}\n\nsce <- bpmapply(\n  FUN = FUN,\n  x = sce,\n  y = fit\n)\n\nFilter empty droplets:\n\nFUN <- function(x, FDR) {\n\n  x[, which(x$EmpDropsFDR < FDR)]\n\n}\n  \nsce <- bplapply(X = sce, FUN = FUN, FDR = params$fdr)"
  },
  {
    "objectID": "analysis/droplet-processing.html#summary",
    "href": "analysis/droplet-processing.html#summary",
    "title": "Droplet processing",
    "section": "Summary",
    "text": "Summary\nSave experiment object(s):\n\nsaveRDS(sce, file = \"output/droplet-processing.rds\")\n\nPrint session information\n\nsessionInfo()\n\nR version 4.1.1 (2021-08-10)\nPlatform: x86_64-apple-darwin17.0 (64-bit)\nRunning under: macOS Big Sur 10.16\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\nattached base packages:\n[1] parallel  stats4    stats     graphics  grDevices utils     datasets \n[8] methods   base     \n\nother attached packages:\n [1] scales_1.2.0                ggplot2_3.3.6              \n [3] patchwork_1.1.1             DropletUtils_1.12.3        \n [5] SingleCellExperiment_1.14.1 SummarizedExperiment_1.22.0\n [7] Biobase_2.52.0              GenomicRanges_1.44.0       \n [9] GenomeInfoDb_1.28.4         IRanges_2.26.0             \n[11] S4Vectors_0.30.2            BiocGenerics_0.38.0        \n[13] MatrixGenerics_1.4.3        matrixStats_0.62.0         \n[15] BiocParallel_1.26.2         BiocSingular_1.8.1         \n[17] BiocNeighbors_1.10.0       \n\nloaded via a namespace (and not attached):\n [1] edgeR_3.34.1              jsonlite_1.8.0           \n [3] DelayedMatrixStats_1.14.3 scuttle_1.2.1            \n [5] R.utils_2.11.0            assertthat_0.2.1         \n [7] dqrng_0.3.0               renv_0.15.4              \n [9] GenomeInfoDbData_1.2.6    yaml_2.3.5               \n[11] pillar_1.7.0              lattice_0.20-45          \n[13] glue_1.6.2                limma_3.48.3             \n[15] beachmat_2.8.1            digest_0.6.29            \n[17] XVector_0.32.0            colorspace_2.0-3         \n[19] htmltools_0.5.2           Matrix_1.4-1             \n[21] R.oo_1.24.0               pkgconfig_2.0.3          \n[23] zlibbioc_1.38.0           purrr_0.3.4              \n[25] ScaledMatrix_1.0.0        HDF5Array_1.20.0         \n[27] tibble_3.1.6              farver_2.1.0             \n[29] generics_0.1.2            ellipsis_0.3.2           \n[31] withr_2.5.0               cli_3.3.0                \n[33] magrittr_2.0.3            crayon_1.5.1             \n[35] evaluate_0.15             R.methodsS3_1.8.1        \n[37] fansi_1.0.3               tools_4.1.1              \n[39] lifecycle_1.0.1           stringr_1.4.0            \n[41] Rhdf5lib_1.14.2           munsell_0.5.0            \n[43] locfit_1.5-9.5            DelayedArray_0.18.0      \n[45] irlba_2.3.5               compiler_4.1.1           \n[47] rsvd_1.0.5                rlang_1.0.2              \n[49] rhdf5_2.36.0              grid_4.1.1               \n[51] RCurl_1.98-1.6            rhdf5filters_1.4.0       \n[53] rstudioapi_0.13           htmlwidgets_1.5.4        \n[55] labeling_0.4.2            bitops_1.0-7             \n[57] rmarkdown_2.14            gtable_0.3.0             \n[59] DBI_1.1.2                 R6_2.5.1                 \n[61] knitr_1.39                dplyr_1.0.9              \n[63] fastmap_1.1.0             utf8_1.2.2               \n[65] stringi_1.7.6             Rcpp_1.0.8.3             \n[67] vctrs_0.4.1               tidyselect_1.1.2         \n[69] xfun_0.30                 sparseMatrixStats_1.4.2"
  },
  {
    "objectID": "analysis/quality-control.html#dependencies",
    "href": "analysis/quality-control.html#dependencies",
    "title": "Quality control",
    "section": "Dependencies",
    "text": "Dependencies\nRestore project dependencies:\n\nrenv::restore()\n\n* The library is already synchronized with the lockfile.\n\n\nNearest neighbor detection:\n\nlibrary(BiocNeighbors)\n\nBNPARAM <- AnnoyParam()\n\nSingular value decomposition:\n\nlibrary(BiocSingular)\n\nBSPARAM <- RandomParam()\n\nParallel evaluation:\n\nlibrary(BiocParallel)\n\nBPPARAM <- MulticoreParam(8)\n\nLoad Bioconductor package(s):\n\nlibrary(scuttle)\n\nLoading required package: SingleCellExperiment\n\n\nLoading required package: SummarizedExperiment\n\n\nLoading required package: MatrixGenerics\n\n\nLoading required package: matrixStats\n\n\nWarning: package 'matrixStats' was built under R version 4.1.2\n\n\n\nAttaching package: 'MatrixGenerics'\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n\n\nLoading required package: GenomicRanges\n\n\nLoading required package: stats4\n\n\nLoading required package: BiocGenerics\n\n\nLoading required package: parallel\n\n\n\nAttaching package: 'BiocGenerics'\n\n\nThe following objects are masked from 'package:parallel':\n\n    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,\n    clusterExport, clusterMap, parApply, parCapply, parLapply,\n    parLapplyLB, parRapply, parSapply, parSapplyLB\n\n\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n\n\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, append, as.data.frame, basename, cbind, colnames,\n    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,\n    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,\n    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,\n    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,\n    union, unique, unsplit, which.max, which.min\n\n\nLoading required package: S4Vectors\n\n\n\nAttaching package: 'S4Vectors'\n\n\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n\n\nLoading required package: IRanges\n\n\nLoading required package: GenomeInfoDb\n\n\nLoading required package: Biobase\n\n\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n\n\n\nAttaching package: 'Biobase'\n\n\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n\n\nLoad CRAN package(s):\n\nlibrary(ggplot2)\nlibrary(scales)\n\nWarning: package 'scales' was built under R version 4.1.2\n\n\nSource project function(s):\nRead experiment object(s):\n\nsce <- readRDS(\"output/droplet-processing.rds\")\n\n\nFUN <- function(x) list(mt = grep(params$prefix, rowData(x)$Symbol))\n\nmit <- bplapply(sce, FUN)\n\nPer-cell quality control metrics:\n\ndat <- bpmapply(\n    FUN = perCellQCMetrics, \n    x = sce, \n    subsets = mit,\n    SIMPLIFY = FALSE\n)\n\nCompute filters for low-quality cells:\n\nout <- bpmapply(\n    FUN = perCellQCFilters, \n    x = dat, \n    MoreArgs = list(sub.fields = TRUE), \n    SIMPLIFY = FALSE\n)\n\nFilter low-quality cells:\n\nFUN <- function(x, y) x[, !y$discard]\n\nsce <- bpmapply(FUN, x = sce, y = out, SIMPLIFY = FALSE)"
  },
  {
    "objectID": "analysis/quality-control.html#summary",
    "href": "analysis/quality-control.html#summary",
    "title": "Quality control",
    "section": "Summary",
    "text": "Summary\n\nParameters\nThis table describes the parameters used in this analysis:\n\npar <- list(\n    list(\n        Parameter = \"nmads\",\n        Value = params$nmads,\n        Description = \"A numeric scalar, specifying the minimum number of MADs away from median required for a value to be called an outlier.\"\n    ),\n    list(\n        Parameter = \"prefix\",\n        Value = params$prefix,\n        Description = \"Mitochondrial gene prefix\"\n    )\n)\n\npar <- jsonlite::toJSON(par, pretty = TRUE)\nknitr::kable(jsonlite::fromJSON(par))\n\n\n\n\n\n\n\n\n\nParameter\nValue\nDescription\n\n\n\n\nnmads\n3\nA numeric scalar, specifying the minimum number of MADs away from median required for a value to be called an outlier.\n\n\nprefix\nMT-\nMitochondrial gene prefix\n\n\n\n\n\nSave experiment object(s):\n\nsaveRDS(sce, file = \"output/quality-control.rds\")\n\nPrint session information\n\nsessionInfo()\n\nR version 4.1.1 (2021-08-10)\nPlatform: x86_64-apple-darwin17.0 (64-bit)\nRunning under: macOS Big Sur 10.16\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\nattached base packages:\n[1] parallel  stats4    stats     graphics  grDevices utils     datasets \n[8] methods   base     \n\nother attached packages:\n [1] scales_1.2.0                ggplot2_3.3.6              \n [3] scuttle_1.2.1               SingleCellExperiment_1.14.1\n [5] SummarizedExperiment_1.22.0 Biobase_2.52.0             \n [7] GenomicRanges_1.44.0        GenomeInfoDb_1.28.4        \n [9] IRanges_2.26.0              S4Vectors_0.30.2           \n[11] BiocGenerics_0.38.0         MatrixGenerics_1.4.3       \n[13] matrixStats_0.62.0          BiocParallel_1.26.2        \n[15] BiocSingular_1.8.1          BiocNeighbors_1.10.0       \n\nloaded via a namespace (and not attached):\n [1] Rcpp_1.0.8.3              rsvd_1.0.5               \n [3] lattice_0.20-45           assertthat_0.2.1         \n [5] digest_0.6.29             utf8_1.2.2               \n [7] R6_2.5.1                  evaluate_0.15            \n [9] highr_0.9                 pillar_1.7.0             \n[11] sparseMatrixStats_1.4.2   zlibbioc_1.38.0          \n[13] rlang_1.0.2               rstudioapi_0.13          \n[15] irlba_2.3.5               Matrix_1.4-1             \n[17] rmarkdown_2.14            stringr_1.4.0            \n[19] htmlwidgets_1.5.4         RCurl_1.98-1.6           \n[21] munsell_0.5.0             beachmat_2.8.1           \n[23] DelayedArray_0.18.0       compiler_4.1.1           \n[25] xfun_0.30                 pkgconfig_2.0.3          \n[27] htmltools_0.5.2           tidyselect_1.1.2         \n[29] tibble_3.1.6              GenomeInfoDbData_1.2.6   \n[31] fansi_1.0.3               withr_2.5.0              \n[33] dplyr_1.0.9               crayon_1.5.1             \n[35] bitops_1.0-7              grid_4.1.1               \n[37] DBI_1.1.2                 jsonlite_1.8.0           \n[39] gtable_0.3.0              lifecycle_1.0.1          \n[41] magrittr_2.0.3            ScaledMatrix_1.0.0       \n[43] cli_3.3.0                 stringi_1.7.6            \n[45] XVector_0.32.0            renv_0.15.4              \n[47] generics_0.1.2            DelayedMatrixStats_1.14.3\n[49] ellipsis_0.3.2            vctrs_0.4.1              \n[51] tools_4.1.1               glue_1.6.2               \n[53] purrr_0.3.4               fastmap_1.1.0            \n[55] yaml_2.3.5                colorspace_2.0-3         \n[57] knitr_1.39"
  },
  {
    "objectID": "analysis/normalization.html",
    "href": "analysis/normalization.html",
    "title": "Normalization",
    "section": "",
    "text": "renv::restore()\n\n* The library is already synchronized with the lockfile.\n\n\nNearest neighbor detection:\n\nlibrary(BiocNeighbors)\n\nBNPARAM <- AnnoyParam()\n\nSingular value decomposition:\n\nlibrary(BiocSingular)\n\nBSPARAM <- RandomParam()\n\nParallel evaluation:\n\nlibrary(BiocParallel)\n\nBPPARAM <- MulticoreParam(8)\n\nLoad Bioconductor package(s):\n\nlibrary(scran)\n\nLoading required package: SingleCellExperiment\n\n\nLoading required package: SummarizedExperiment\n\n\nLoading required package: MatrixGenerics\n\n\nLoading required package: matrixStats\n\n\nWarning: package 'matrixStats' was built under R version 4.1.2\n\n\n\nAttaching package: 'MatrixGenerics'\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n\n\nLoading required package: GenomicRanges\n\n\nLoading required package: stats4\n\n\nLoading required package: BiocGenerics\n\n\nLoading required package: parallel\n\n\n\nAttaching package: 'BiocGenerics'\n\n\nThe following objects are masked from 'package:parallel':\n\n    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,\n    clusterExport, clusterMap, parApply, parCapply, parLapply,\n    parLapplyLB, parRapply, parSapply, parSapplyLB\n\n\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n\n\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, append, as.data.frame, basename, cbind, colnames,\n    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,\n    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,\n    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,\n    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,\n    union, unique, unsplit, which.max, which.min\n\n\nLoading required package: S4Vectors\n\n\n\nAttaching package: 'S4Vectors'\n\n\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n\n\nLoading required package: IRanges\n\n\nLoading required package: GenomeInfoDb\n\n\nLoading required package: Biobase\n\n\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n\n\n\nAttaching package: 'Biobase'\n\n\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n\n\nLoading required package: scuttle\n\n\nRead experiment object(s):\n\nsce <- readRDS(\"output/quality-control.rds\")\n\nQuick clustering of cells:\n\ncol <- bplapply(\n    X = sce, \n    FUN = quickCluster\n)\n\nNormalization by deconvolution:\n\nsce <- bpmapply(\n    FUN = computeSumFactors, \n    x = sce, \n    clusters = col, \n    SIMPLIFY = FALSE\n)\n\nCompute log-normalized expression values:\n\nsce <- bplapply(sce, logNormCounts)\n\nSave experiment object(s):\n\nsaveRDS(sce, file = \"output/normalization.rds\")\n\nPrint session information\n\nsessionInfo()\n\nR version 4.1.1 (2021-08-10)\nPlatform: x86_64-apple-darwin17.0 (64-bit)\nRunning under: macOS Big Sur 10.16\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\nattached base packages:\n[1] parallel  stats4    stats     graphics  grDevices utils     datasets \n[8] methods   base     \n\nother attached packages:\n [1] scran_1.20.1                scuttle_1.2.1              \n [3] SingleCellExperiment_1.14.1 SummarizedExperiment_1.22.0\n [5] Biobase_2.52.0              GenomicRanges_1.44.0       \n [7] GenomeInfoDb_1.28.4         IRanges_2.26.0             \n [9] S4Vectors_0.30.2            BiocGenerics_0.38.0        \n[11] MatrixGenerics_1.4.3        matrixStats_0.62.0         \n[13] BiocParallel_1.26.2         BiocSingular_1.8.1         \n[15] BiocNeighbors_1.10.0       \n\nloaded via a namespace (and not attached):\n [1] statmod_1.4.36            locfit_1.5-9.5           \n [3] xfun_0.30                 beachmat_2.8.1           \n [5] lattice_0.20-45           htmltools_0.5.2          \n [7] yaml_2.3.5                rlang_1.0.2              \n [9] dqrng_0.3.0               GenomeInfoDbData_1.2.6   \n[11] stringr_1.4.0             zlibbioc_1.38.0          \n[13] rsvd_1.0.5                ScaledMatrix_1.0.0       \n[15] htmlwidgets_1.5.4         evaluate_0.15            \n[17] knitr_1.39                fastmap_1.1.0            \n[19] irlba_2.3.5               Rcpp_1.0.8.3             \n[21] edgeR_3.34.1              renv_0.15.4              \n[23] limma_3.48.3              DelayedArray_0.18.0      \n[25] jsonlite_1.8.0            XVector_0.32.0           \n[27] metapod_1.0.0             digest_0.6.29            \n[29] stringi_1.7.6             bluster_1.2.1            \n[31] grid_4.1.1                cli_3.3.0                \n[33] tools_4.1.1               bitops_1.0-7             \n[35] magrittr_2.0.3            RCurl_1.98-1.6           \n[37] cluster_2.1.3             pkgconfig_2.0.3          \n[39] Matrix_1.4-1              DelayedMatrixStats_1.14.3\n[41] sparseMatrixStats_1.4.2   rmarkdown_2.14           \n[43] rstudioapi_0.13           igraph_1.3.1             \n[45] compiler_4.1.1"
  }
]