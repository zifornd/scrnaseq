# Marker gene detection

Load Bioconductor package(s):

```{r}
library(scran)
```

Read experiment object:

```{r}
sce <- readRDS("object.rds")
```

```{r}
res <- scoreMarkers(sce, sce$groups, block = sce$batch, BPPARAM = BPP)
```


```{r}
df <- makePerCellDF(sce, features = res,)
```

```{r}
ggplot(data = data, mapping = aes(x = cluster, y = logcounts)) + facet_grid(gene ~ batch)
```

Save experiment object:

```{r}
saveRDS(sce, file = "marker-detection.rds")
```

Print session information:

```{r}
sessionInfo()
```
